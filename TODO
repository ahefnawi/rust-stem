rewrite the code to be more idiomatic Rust
